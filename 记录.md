原来heap4.c中的
```c
static void prvInsertBlockIntoFreeList( BlockLink_t * pxBlockToInsert ) PRIVILEGED_FUNCTION;
static void prvHeapInit( void ) PRIVILEGED_FUNCTION;
void * pvPortMalloc( size_t xWantedSize )
void vPortFree( void * pv )
size_t xPortGetFreeHeapSize( void )
size_t xPortGetMinimumEverFreeHeapSize( void )
void vPortInitialiseBlocks( void )
void * pvPortCalloc( size_t xNum,
                     size_t xSize )
void vPortGetHeapStats( HeapStats_t * pxHeapStats )
void vPortHeapResetState( void )
```

简化之后的heap.c中的
```c
static void prvInsertBlockIntoFreeList( BlockLink_t * pxBlockToInsert ) PRIVILEGED_FUNCTION;
static void prvHeapInit( void ) PRIVILEGED_FUNCTION;
// 只保留了这四个函数
void * pvPortMalloc( size_t xWantedSize )
void vPortFree( void * pv )
size_t xPortGetFreeHeapSize( void )
size_t xPortGetMinimumEverFreeHeapSize( void )
```

这个内存管理完全就是从FreeRTOS中提取出来的，其中一些对FreeRTOS的依赖去掉了，还有一些宏也去掉了。需要注意的是，需要根据实际情况提供，如果是多任务环境就直接使用对应的RTOS的临界区函数，如果是裸机，可以添加disable_irq类似的函数，其实不添加影响也不大，
```c
/* 线程安全锁定机制：在多线程/抢占式环境下，需在此填入关中断或获取互斥锁的代码 */
#define HEAP_LOCK()     
#define HEAP_UNLOCK()   
```























